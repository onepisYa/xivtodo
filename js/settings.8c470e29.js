"use strict";(self["webpackChunkxivtodo"]=self["webpackChunkxivtodo"]||[]).push([[571],{79:function(t,e,s){s.r(e),s.d(e,{default:function(){return yt}});var a=s(252),r=s(577),n=s(963);const l={class:"container"},i=(0,a._)("hr",null,null,-1),o={name:"settings-form",id:"settings-form"},c={class:"row"},p={class:"col-lg-6"},d=(0,a._)("h2",null,"Characters",-1),u=(0,a._)("h3",null,"Add a new character",-1),h={class:"mb-3"},g=(0,a._)("label",{for:"inputCharacterID",class:"form-label"},"Profile URL",-1),m=(0,a._)("div",{class:"form-text"},[(0,a.Uk)(" The URL for your character profile. You can find it in "),(0,a._)("a",{class:"text-reset",href:"https://na.finalfantasyxiv.com/lodestone/character/",target:"_blank",rel:"noopener noreferrer"},"Lodestone"),(0,a.Uk)(". ")],-1),f={key:0,type:"button",id:"settings-save-btn",class:"btn btn-success",disabled:""},b=(0,a._)("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},null,-1),y=(0,a.Uk)(" Adding, please wait... "),k=[b,y],_=(0,a._)("br",null,null,-1),v=(0,a._)("br",null,null,-1),w=(0,a._)("h3",null,"Your characters",-1),C={key:2,class:"list-group list-group-flush"},D=(0,a._)("li",{class:"list-group-item d-flex justify-content-between align-items-start"}," Once you add your characters, they will appear here. ",-1),U=[D],S={key:3,class:"list-group list-group-flush"},O={class:"ms-2 me-auto"},x=["src"],$={style:{float:"left"}},L={class:"fw-bold"},A=(0,a._)("br",null,null,-1),R={key:0,class:"text-info fw-light"},I=(0,a._)("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),M=(0,a.Uk)(" Updating character data... "),V=[I,M],P={key:1,class:"text-muted fw-light"},Y={key:0,class:"text-warning"},q=(0,a._)("br",null,null,-1),z=(0,a._)("abbr",{title:"The achievements for this characters are not set to public in Lodestone."}," Achievements are not public ",-1),G=[q,z],N=["onClick"],j=(0,a._)("span",{class:"tt-text"},"Update data",-1),B=[j],T=(0,a.Uk)("    "),W=["onClick"],Z=(0,a._)("span",{class:"tt-text"},"Remove character",-1),H=[Z],K=(0,a._)("br",null,null,-1),E={class:"col-lg-6"},F=(0,a._)("h2",null,"General",-1),J=(0,a._)("h3",null,"Content spoilers",-1),Q={class:"form-check"},X=(0,a._)("label",{class:"form-check-label",for:"inputSpoilersOption0"}," Blur out non-completed story-related encounters ",-1),tt={class:"form-check"},et=(0,a._)("label",{class:"form-check-label",for:"inputSpoilersOption1"}," Blur out all story-related encounters ",-1),st={class:"form-check"},at=(0,a._)("label",{class:"form-check-label",for:"inputSpoilersOption2"},"Show all encounters",-1),rt=(0,a._)("div",{class:"form-text"},"Preference in hiding potential spoilers.",-1),nt=(0,a._)("br",null,null,-1),lt={key:0,type:"button",id:"settings-save-btn",class:"btn btn-success",disabled:""},it=(0,a._)("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},null,-1),ot=(0,a.Uk)(" Updating, please wait... "),ct=[it,ot],pt=(0,a._)("br",null,null,-1),dt=(0,a._)("br",null,null,-1);function ut(t,e,s,b,y,D){const I=(0,a.up)("AlertMsg");return(0,a.wg)(),(0,a.iD)("div",l,[(0,a._)("h1",null,(0,r.zw)(t.$t("page.settings")),1),y.error.msg?((0,a.wg)(),(0,a.j4)(I,{key:0,type:y.error.type,msg:y.error.msg},null,8,["type","msg"])):(0,a.kq)("",!0),i,(0,a._)("form",o,[(0,a._)("div",c,[(0,a._)("div",p,[d,u,(0,a._)("div",h,[g,(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>y.profileURL=t),type:"text",class:"form-control",id:"inputCharacterID",placeholder:"https://na.finalfantasyxiv.com/lodestone/character/12345/"},null,512),[[n.nr,y.profileURL]]),m]),y.adding?((0,a.wg)(),(0,a.iD)("button",f,k)):((0,a.wg)(),(0,a.iD)("button",{key:1,onClick:e[1]||(e[1]=(...t)=>D.addCharacter&&D.addCharacter(...t)),type:"button",id:"settings-save-btn",class:(0,r.C_)(["btn btn-success",{disabled:!y.profileURL}])}," Add character ",2)),_,v,w,this.$store.getters.hasCharacter?((0,a.wg)(),(0,a.iD)("ul",S,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(this.$store.getters.characters,((t,e)=>((0,a.wg)(),(0,a.iD)("li",{key:t.ID,class:"list-group-item d-flex justify-content-between align-items-start"},[(0,a._)("div",O,[(0,a._)("img",{style:{display:"block",float:"left",height:"50px"},class:"avatar-list",src:t.lodestoneData.Character.Avatar,alt:"Portrait of your character"},null,8,x),(0,a._)("div",$,[(0,a._)("span",L,(0,r.zw)(t.lodestoneData.Character.Name),1),(0,a.Uk)(" – "+(0,r.zw)(t.lodestoneData.Character.World)+" ",1),A,this.updating==t.lodestoneData.Character.ID||this.$store.getters.characterOutOfDate(e)?((0,a.wg)(),(0,a.iD)("span",R,V)):((0,a.wg)(),(0,a.iD)("span",P,[(0,a.Uk)(" Last updated "+(0,r.zw)(D.lastUpdatedAt(t.updated))+" ",1),t.lodestoneData.Achievements&&0!=t.lodestoneData.Achievements.length?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("span",Y,G))]))])]),y.updating||this.$store.getters.characterOutOfDate(e)?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("a",{key:0,class:"bi-arrow-repeat text-secondary cursor-pointer tt",onClick:e=>D.updateCharacter(t.lodestoneData.Character.ID)},B,8,N)),T,y.updating?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("a",{key:1,class:"bi-trash text-danger cursor-pointer tt",onClick:t=>D.removeCharacter(e)},H,8,W))])))),128))])):((0,a.wg)(),(0,a.iD)("ul",C,U)),K]),(0,a._)("div",E,[F,J,(0,a._)("div",Q,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>y.settings.spoilersOption=t),class:"form-check-input",type:"radio",name:"inputSpoilersOption",id:"inputSpoilersOption0",value:0},null,512),[[n.G2,y.settings.spoilersOption]]),X]),(0,a._)("div",tt,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>y.settings.spoilersOption=t),class:"form-check-input",type:"radio",name:"inputSpoilersOption",id:"inputSpoilersOption1",value:1},null,512),[[n.G2,y.settings.spoilersOption]]),et]),(0,a._)("div",st,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>y.settings.spoilersOption=t),class:"form-check-input",type:"radio",name:"inputSpoilersOption",id:"inputSpoilersOption2",value:2},null,512),[[n.G2,y.settings.spoilersOption]]),at]),rt,nt,y.updatingSettings?((0,a.wg)(),(0,a.iD)("button",lt,ct)):((0,a.wg)(),(0,a.iD)("button",{key:1,onClick:e[5]||(e[5]=(...t)=>D.updateSettings&&D.updateSettings(...t)),type:"button",id:"settings-save-btn",class:"btn btn-success"}," Update settings ")),pt,dt])])])])}var ht=s(903),gt=s(26),mt={name:"SettingsView",data(){return{adding:!1,updatingSettings:!1,updating:0,error:{},profileURL:"",settings:{...this.$store.getters.settings}}},components:{AlertMsg:ht.Z},methods:{updateSettings(){this.updatingSettings=!0,this.error={},(0,gt.VP)(this.settings).then((t=>{this.$store.commit("setSettings",t),this.error={type:"success",msg:"Settings updated!"}})).catch((t=>{this.error={type:"error",msg:`Settings could not be updated: ${t}`}})).finally((()=>{this.updatingSettings=!1}))},addCharacter(){this.adding=!0,this.error={},this.profileURL.endsWith("/")&&(this.profileURL=this.profileURL.slice(0,-1));let t=this.profileURL.split("/").slice(-1).pop();(0,gt.y8)(t).then((t=>{this.$store.commit("addCharacter",t),t.lodestoneData.Achievements&&0!=t.lodestoneData.Achievements.length?this.error={type:"success",msg:`Character <b>${t.lodestoneData.Character.Name}</b> added! You can now access your <a href='/profile' class='alert-link'>Profile</a> and all character completion pages.`}:this.error={type:"warning",msg:`Character <b>${t.lodestoneData.Character.Name}</b> added, but their achievements are not set to public. You can change that setting <a href='https://na.finalfantasyxiv.com/lodestone/my/setting/account/' class='alert-link' target='_blank' rel='noopener noreferrer'>here</a>, and then update the character's data.`}})).catch((t=>{console.log(t),this.error={type:"error",msg:t.toString()}})).finally((()=>{this.profileURL="",this.adding=!1}))},updateCharacter(t){this.updating=t,this.error={},(0,gt.y8)(t).then((t=>{this.$store.commit("addCharacter",t)})).catch((t=>{console.log(t),this.error={type:"error",msg:t.toString()}})).finally((()=>{this.profileURL="",this.updating=null}))},removeCharacter(t){this.updating=!0,this.error={};let e=this.$store.getters.characters[t].lodestoneData.Character.ID,s=this.$store.getters.characters[t].lodestoneData.Character.Name;(0,gt.cy)(e).then((()=>{this.$store.commit("removeCharacter",t),this.error={type:"success",msg:`Character <b>${s}</b> removed!`}})).catch((t=>{console.log(t),this.error={type:"error",msg:t.toString()}})).finally((()=>{this.updating=!1}))},lastUpdatedAt(t){let e=new Date/1e3,s=e-t,a=Math.floor(s/2592e3),r=Math.floor(s/86400),n=Math.floor(s/3600),l=Math.floor(s/60);return l<2?"a couple seconds ago":l<120?l+" minutes ago":n<48?n+" hours ago":r<60?r+" days ago":a+" months ago"}}},ft=s(744);const bt=(0,ft.Z)(mt,[["render",ut]]);var yt=bt}}]);
//# sourceMappingURL=settings.8c470e29.js.map